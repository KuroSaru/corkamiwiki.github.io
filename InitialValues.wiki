#summary Initial values of cpu registers on Windows OSes
#labels WIP
_IN PROGRESS_
=Common=

==Flags==
always 246 (except NT4 EP), on !EntryPoint or TLS.

==Selectors==
Standard for 32b:
|| CS || DS || ES || FS || SS || GS ||
|| 001B || 0023 || 0023 || 003B || 0023 ||0000 ||

Exception: FS is `38` under NT4/2k/XPSP1, but `3B` on any XP sp>=2/Vista/7

for 64b (CPU, not OS => even on 32b os on 64b cpu):
|| CS || DS || ES || FS || SS || GS ||
||23||2B||2B||53||2B||2B||

=Registers=
 * at Entrypoint:
  * XP or older ? EAX = 0
  * Vista or more recent ? EAX = 7xxxxxxxxh

 * TLS
  * ECX = `DataDirectory[TLS].size`

 * STR
  * CPU = 64b ? 40h
  * CPU = 32b ? 28h
----

=specific=
==NT 4==
{{{
TLS: EDI:00401194 ESI:00400000 EBP:0012FAF8 ESP:0012FAB4 EBX:00140818 EDX:00001180 ECX:00000000 EAX:0040114F
EntryPoint Flags:0216 EDI:00000000 ESI:00000018 EBP:0012FFF0 ESP:0012FFC0 EBX:7FFDF000 EDX:FFFFFFFF ECX:00000101 EAX:00000000

CR0(before):80010031  CR0(after):80010031
GDT:8003600003FF IDT:8003640007FF STR:00000028
}}}

==2000==
{{{
TLS:        EDI:00400000 ESI:0006F8AC EBP:0006F8B8 ESP:0006F898 EBX:00000000 EDX:000010EC ECX:00000000 EAX:004010C8
EntryPoint  EDI:00000001 ESI:00000008 EBP:0006FFF0 ESP:0006FFC0 EBX:7FFDF000 EDX:FFFFFFFF ECX:00000101 EAX:00000000

CR0(after):80010031  CR0(before):80010031
GDT:8003600003FF IDT:8003640007FF STR:00000028
}}}

==XP SP1 + !VmWare==

(Executable info: TLS callback RVA 03EC103C, TLS DD RVA:11EC Size: A3B1, !ImageBase: 03EC0000)

 * OS Version
|| Version || Platform || !ServicePack || Suite || Product ||
|| 5.1.2600 || 2 || 1.0 || 0100 || 1 ||

 * selectors
|| CS || DS || ES || FS || SS || GS ||
|| 1B || 23 || 23 || 3B || 23 || 0 ||

 * system registers
|| CR0 || LDT || GDT || IDT || Task Register ||
|| 80010031|| 00000000 || 8003F00003FF || 8003F40007FF || 00000028 ||

 * general registers
|| *execution point* || || Flags || EDI || ES || EBP || ESP || EBX || EDX || ECX || EAX ||
||||||||||||||||||||||||
|| TLS || || 0246 || 03EC0000 || 0012F9E4 || 0012F9F0 || 0012F9D0 || 00000000 || 000011EC || 0000A3B1 || 03EC103C ||
|| !EntryPoint || || 0286 || 00000000 || 00000002 || 0012FFF0 || 0012FFC0 || 7FFDF000 || 7FFE0304 || 0012FFB0 || 00000000 ||
|| DLL !EntryPoint || || 0202 || 00000001 || 0012F8F8 || 0012F904 || 0012F8E4 || 05EC1000 || 00181EAC || 00000001 || 0012F958 ||

=== + !OllyDbg ===
{{{
TLS:        EDI:00400000 ESI:0006F9E4 EBP:0006F9F0 ESP:0006F9D0 EBX:00000000 EDX:000010EC ECX:00000000 EAX:004010C8
EntryPoint  EDI:00000141 ESI:00000000 EBP:0006FFF0 ESP:0006FFC0 EBX:7FFDF000 EDX:7FFE0304 ECX:0006FFB0 EAX:00000000

CR0(after):80010031  CR0(before):8001003B
GDT:8003F00003FF IDT:8003F40007FF STR:00000028
}}}


==XP SP2 32b==
{{{
TLS         EDI:00400000 ESI:0012F9C0 EBP:0012F9CC ESP:0012F9AC EBX:00000000 EDX:000010EC ECX:00000000 EAX:004010C8
EntryPoint  EDI:1EB10AA2 ESI:01CC55D3 EBP:0012FFF0 ESP:0012FFC0 EBX:7FFDB000 EDX:7C90E514 ECX:0012FFB0 EAX:00000000

CR0(after):80010031  CR0(before):80010031
GDT:BA34419003FF IDT:BA34459007FF STR:00000028
}}}

===+ !VmWare===
{{{
TLS:        EDI:00400000 ESI:0012F9C0 EBP:0012F9CC ESP:0012F9AC EBX:00000000 EDX:000010EC ECX:00000000 EAX:004010C8
EntryPoint  EDI:40C85EAA ESI:01CC55CF EBP:0012FFF0 ESP:0012FFC0 EBX:7FFDF000 EDX:7C90EB94 ECX:0012FFB0 EAX:00000000

CR0(after):80010031  CR0(before):80010031
GDT:8003F00003FF IDT:8003F40007FF STR:00000028
}}}

==XP SP3 32b==
(Executable info: TLS callback RVA 03EC103C, TLS DD RVA:11EC Size: E465, !ImageBase: 03EC0000)
 * OS Version
|| Version || Platform || !ServicePack || Suite || Product ||
|| 5.1.2600 || 2 || 3.0 || 0300 || 1 ||

 * selectors
|| CS || DS || ES || FS || SS || GS ||
|| 1B || 23 || 23 || 3B || 23 || 0 ||

 * system registers
|| CR0 || LDT || GDT || IDT || Task Register ||
|| 80010031|| 00000000 || 8003F00003FF || 8003F40007FF || 00000028 ||

 * general registers
|| *execution point* || || Flags || || EDI || ESI || EBP || ESP || EBX || EDX || ECX || EAX ||
||||||||||||||||||||||||||
|| TLS || || 0246 || || 03EC0000 || 0012F9C0 || 0012F9CC || 0012F9AC || 00000000 || 000011EC || 0000E465 || 03EC103C ||
|| !EntryPoint || || 0246 || || 00000016 || 00000000 || 0012FFF0 || 0012FFC0 || 7FFD7000 || 7C90E514 || 0012FFB0 || 00000000 ||
|| DLL !EntryPoint || || 0202 || || 00000001 || 0012F8B8 || 0012F8C4 || 0012F8A4 || 05EC1000 || 00000040 || FFFFFFFF || 0012F930 ||

==Vista SP1 32b (x64 cpu)==
{{{
TLS         EDI:002E3DC8 ESI:000CF9F8 EBP:000CFA04 ESP:000CF9E4 EBX:004010C8 EDX:77F02080 ECX:00000011 EAX:00000000
EntryPoint  EDI:00000000 ESI:00000000 EBP:000CFF94 ESP:000CFF88 EBX:7EFDE000 EDX:00401010 ECX:00000000 EAX:76623665

CR0(after):80050033  CR0(before):80050033
GDT:B95000007F IDT:B950800FFF STR:00000040
}}}

==Vista SP2 32bit==
{{{
TLS         EDI:00401100 ESI:0006F9FC EBP:0006FA08 ESP:0006F9E8 EBX:004010C8 EDX:772E53D8 ECX:000E2650 EAX:00000000
EntryPoint  EDI:00000000 ESI:00000000 EBP:0006FF94 ESP:0006FF88 EBX:7FFDB000 EDX:00401010 ECX:00000000 EAX:764ED0D7

CR0(after):80010031  CR0(before):8001003B
GDT:803D45D003FF IDT:803D49D007FF STR:00000028
}}}

==W7 32b==
{{{
TLS:        EDI:002817D8 ESI:0006FA10 EBP:0006FA1C ESP:0006F9FC EBX:004010C8 EDX:77C4CD48 ECX:00000011 EAX:00000000
EntryPoint  EDI:00000000 ESI:00000000 EBP:0006FF94 ESP:0006FF88 EBX:7FFD5000 EDX:00401010 ECX:00000000 EAX:7797ED5A

CR0(after):80010031  CR0(before):8001003B
GDT:807CEC2003FF IDT:807CF02007FF STR:00000028
}}}


==W7 64b==
(Executable info: TLS callback RVA 03EC103C, TLS DD RVA:11EC Size: E465, !ImageBase: 03EC0000)
 * OS Version
|| Version || Platform || !ServicePack || Suite || Product ||
|| 6.1.7601 || 2 || 1.0 || 0100 || 1 ||

 * selectors
|| CS || DS || ES || FS || SS || GS ||
|| 23 || 2B || 2B || 53 || 2B || 2B ||

 * system registers
|| CR0 || LDT || GDT || IDT || Task Register ||
|| 80050031|| 00000000 || 0316F640007F || 0316F6C00FFF || 00000040 ||

 * general registers
|| *execution point* || || Flags || || EDI || ES || EBP || ESP || EBX || EDX || ECX || EAX ||
||||||||||||||||||||||||
|| TLS || || 0246 || || 00413C30 || 000CF9F4 || 000CFA00 || 000CF9E0 || 03EC103C || 77F12080 || 00000011 || 00000000 ||
|| !EntryPoint || || 0246 || || 00000000 || 00000000 || 000CFF94 || 000CFF88 || 7EFDE000 || 03EC1000 || 00000000 || 77093388 ||
|| DLL TLS || || 0246 || || 00414FF0 || 000CFC24 || 000CFC30 || 000CFC10 || 02EC1034 || 77F12080 || 00000011 || 00000000 ||
|| DLL !EntryPoint || || 0246 || || 000CFD1C || 000CFC60 || 000CFC6C || 000CFC4C || 00000001 || 00000000 || 77E71BCB || 00000000 ||

=== +!OllyDbg===
{{{
TLS:        EDI:001C3A48 ESI:000CF9F4 EBP:000CFA00 ESP:000CF9E0 EBX:004010C8 EDX:778B2080 ECX:00000011 EAX:00000000
EntryPoint  EDI:00000000 ESI:00000000 EBP:000CFF94 ESP:000CFF88 EBX:7EFDE000 EDX:00401010 ECX:00000000 EAX:75293388

CR0(after):80050031  CR0(before):80050031
GDT:316F640007F IDT:316F6C00FFF STR:00000040
}}}

=== +!WinDbg===
{{{
TLS:        EDI:00273940 ESI:000CF9F4 EBP:000CFA00 ESP:000CF9E0 EBX:004010C8 EDX:778B2080 ECX:00000011 EAX:00000000
EntryPoint  EDI:00000000 ESI:00000000 EBP:000CFF94 ESP:000CFF88 EBX:7EFDE000 EDX:00401010 ECX:00000000 EAX:75293388

CR0(after):80050031  CR0(before):80050031
GDT:9BD640007F IDT:9BD6C00FFF STR:00000040
}}}

----
===Greetings===
 * Adam Blaszczyk
 * Markus Hinderhofer
 * Moritz Kroll
 * Peter Ferrie